# openclaw-agi (prototype)

> NOTE: This repository was generated by LLMs as a quick prototype. Expect rough edges.

A **recursive self-improvement pipeline** for OpenClaw / Clawdbot session traces (JSONL).

Core idea: mine grounded signals from real agent work, roll them up into clusters, convert those into tickets (or ticket IR), then drive research briefs and experiments. Repeat.

## Pipeline (end-to-end)

1) **Mine signals** from session JSONL (errors, frustration, suggestions, proactive opportunities, delight)
2) **Roll up** signals into clusters with fingerprints + ranking
3) **Export ticket IR** for any ticket system (optional)
4) **Create/update tickets** in Phorge (optional)
5) **Generate research briefs** for top items
6) **Run experiments + fixes**, then re-run the pipeline

## Install

```bash
cd /home/debian/clawd/home/rlm-session-analyzer
python -m venv .venv
source .venv/bin/activate
pip install -U pip
pip install -e .
```

## 1) Mine self-improvement signals

Kinds emitted by the LLM:
- error
- user_frustration
- improvement_suggestion
- experiment_suggestion
- proactive_opportunity
- user_delight
- other

Example:

```bash
openclaw-trace mine-signals \
  --sessions-dir /home/debian/.clawdbot/agents/main/sessions \
  --include "**/*.jsonl" \
  --max-sessions 120 \
  --out-jsonl out_signals.jsonl \
  --out-json out_signals.json
```

Disable the LLM (heuristic-only, no API key required):

```bash
openclaw-trace mine-signals \
  --sessions-dir /home/debian/.clawdbot/agents/main/sessions \
  --max-sessions 50 \
  --llm none \
  --out-jsonl out_signals.jsonl
```

## 2) Roll up signals (clusters + ranking)

```bash
openclaw-trace rollup-signals \
  --in-jsonl out_signals.jsonl \
  --out-json rollup.json \
  --out-md rollup.md
```

Optional merge pass (lexical + LLM confirm):

```bash
openclaw-trace rollup-signals \
  --in-jsonl out_signals.jsonl \
  --out-json rollup.json \
  --out-md rollup.md \
  --merge-similar \
  --merge-llm --llm openai
```

Rollups include `fingerprint_id` and a lightweight `kind_v2` mapping.

## 3) Export ticket IR (for non-Phorge users)

```bash
python scripts/export_ticket_ir.py \
  --in-json rollup.json \
  --out-jsonl ticket_ir.jsonl
```

This IR is system-agnostic and can be imported into any ticketing system.

## 4) Create/update Phorge tickets (optional)

```bash
python scripts/ticket_rollup.py \
  --in-json rollup.json \
  --dry-run
```

Or from ticket IR:

```bash
python scripts/ticket_rollup.py \
  --in-jsonl ticket_ir.jsonl \
  --dry-run
```

Remove `--dry-run` to create/update tasks.

## 5) Research briefs (headless)

Template:

```
docs/research-briefs/BRIEF_TEMPLATE.md
```

Run (Claude Code + optional Codex critic):

```bash
python scripts/run_research_brief.py \
  --ticket-id 145 \
  --context rollup.json \
  --critic
```

## Privacy / PII

- `mine-signals` is instructed not to emit PII, but v1 redaction is minimal.
- `rollup-signals` redacts summaries and avoids verbatim evidence quotes.
- If you need hard guarantees, add a dedicated redaction step.

## Notes / limitations

- The safe-exec sandbox is a best-effort guardrail, not a security boundary.
- For very large trace corpora, add an on-disk index + lazy windows.

## API key behavior

- Default is `--llm openai`. If `OPENAI_API_KEY` is missing, the CLI exits (no silent fallback).
- Use `--llm none` only for dry runs / testing.

## Daily pipeline script (no cron)

The script runs the full loop and writes all outputs to a timestamped folder.
OpenClaw should own the cron/scheduling so it can review daily progress.

```bash
scripts/run_daily_pipeline.sh
```

Env overrides:
- `SESSIONS_DIR`, `INCLUDE_GLOB`, `MAX_SESSIONS`, `OUT_ROOT`
- `MERGE_SIMILAR=1|0`, `MERGE_LLM=1|0`, `TICKET_CREATE=1|0`
